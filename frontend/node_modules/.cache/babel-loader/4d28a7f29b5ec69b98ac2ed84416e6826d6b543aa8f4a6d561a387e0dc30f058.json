{"ast":null,"code":"var _jsxFileName = \"C:\\\\msms\\\\msms\\\\frontend\\\\src\\\\postlogin\\\\User\\\\checkout.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Checkout = () => {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    order,\n    totalPrice,\n    clearCart\n  } = location.state;\n  useEffect(() => {\n    if (!order || !totalPrice) {\n      console.error(\"Error: Missing order or total price details.\");\n      return;\n    }\n    const loadRazorpay = () => {\n      const script = document.createElement(\"script\");\n      script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n      script.onload = () => {\n        initializeRazorpay();\n      };\n      script.onerror = () => {\n        alert(\"Failed to load Razorpay script. Please try again.\");\n      };\n      document.body.appendChild(script);\n      return () => {\n        document.body.removeChild(script);\n      };\n    };\n    const initializeRazorpay = () => {\n      const options = {\n        key: \"rzp_test_a6hVvFHJbT9SAO\",\n        amount: totalPrice * 100,\n        // Total price in paise\n        currency: \"INR\",\n        name: \"Your Company Name\",\n        description: `Payment for Order #${order.id}`,\n        order_id: order.id,\n        handler: async response => {\n          try {\n            console.log(\"Payment successful, response:\", response);\n            const {\n              razorpay_payment_id,\n              razorpay_order_id,\n              razorpay_signature\n            } = response;\n\n            // Prepare payment data for backend\n            const paymentData = {\n              razorpay_payment_id,\n              razorpay_order_id,\n              razorpay_signature,\n              amount: totalPrice * 100\n            };\n\n            // Send payment data to backend\n            const paymentResponse = await axios.post(\"http://localhost:8000/medical_store_app/payment_details/\", paymentData);\n            console.log(\"Payment recorded in backend:\", paymentResponse.data);\n\n            // Clear the cart\n            if (typeof clearCart === \"function\") {\n              console.log(\"Clearing cart...\");\n              clearCart(); // Clear cart in parent component\n            } else {\n              console.warn(\"clearCart function is not defined or not passed.\");\n            }\n\n            // Redirect to booking page\n            navigate(\"/booking\", {\n              state: {\n                order,\n                paymentDetails: paymentData\n              }\n            });\n          } catch (error) {\n            console.error(\"Error processing payment:\", error);\n            alert(\"Payment was successful, but there was an issue processing the order. Please contact support.\");\n          }\n        },\n        prefill: {\n          name: \"Customer Name\",\n          email: \"customer@example.com\",\n          contact: \"9999999999\"\n        },\n        theme: {\n          color: \"#F37254\"\n        },\n        modal: {\n          ondismiss: () => {\n            alert(\"Payment cancelled. You can try again.\");\n          }\n        }\n      };\n      const razorpay = new window.Razorpay(options);\n      razorpay.open();\n    };\n    loadRazorpay();\n  }, [order, totalPrice, navigate, clearCart]);\n  if (!order || !totalPrice) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.error,\n      children: \"Error: Missing order or total price details.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: styles.heading,\n      children: \"Checkout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: styles.message,\n      children: \"Your payment is being processed, please wait...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n};\n_s(Checkout, \"fPjCxODVr6jVvib6o2c9VLE4s84=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = Checkout;\nconst styles = {\n  container: {\n    padding: '20px',\n    textAlign: 'center',\n    fontFamily: 'Arial, sans-serif',\n    backgroundColor: '#f4f4f9',\n    borderRadius: '8px',\n    boxShadow: '0 4px 8px rgba(0, 0, 0, 0.1)',\n    maxWidth: '600px',\n    margin: 'auto'\n  },\n  heading: {\n    fontSize: '24px',\n    color: '#333',\n    marginBottom: '20px'\n  },\n  message: {\n    fontSize: '18px',\n    color: '#555'\n  },\n  error: {\n    color: 'red',\n    fontSize: '18px',\n    textAlign: 'center',\n    marginTop: '20px'\n  }\n};\nexport default Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","useEffect","useLocation","useNavigate","axios","jsxDEV","_jsxDEV","Checkout","_s","location","navigate","order","totalPrice","clearCart","state","console","error","loadRazorpay","script","document","createElement","src","onload","initializeRazorpay","onerror","alert","body","appendChild","removeChild","options","key","amount","currency","name","description","id","order_id","handler","response","log","razorpay_payment_id","razorpay_order_id","razorpay_signature","paymentData","paymentResponse","post","data","warn","paymentDetails","prefill","email","contact","theme","color","modal","ondismiss","razorpay","window","Razorpay","open","style","styles","children","fileName","_jsxFileName","lineNumber","columnNumber","container","heading","message","_c","padding","textAlign","fontFamily","backgroundColor","borderRadius","boxShadow","maxWidth","margin","fontSize","marginBottom","marginTop","$RefreshReg$"],"sources":["C:/msms/msms/frontend/src/postlogin/User/checkout.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst Checkout = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { order, totalPrice, clearCart } = location.state;\r\n\r\n  useEffect(() => {\r\n    if (!order || !totalPrice) {\r\n      console.error(\"Error: Missing order or total price details.\");\r\n      return;\r\n    }\r\n\r\n    const loadRazorpay = () => {\r\n      const script = document.createElement(\"script\");\r\n      script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n\r\n      script.onload = () => {\r\n        initializeRazorpay();\r\n      };\r\n\r\n      script.onerror = () => {\r\n        alert(\"Failed to load Razorpay script. Please try again.\");\r\n      };\r\n\r\n      document.body.appendChild(script);\r\n\r\n      return () => {\r\n        document.body.removeChild(script);\r\n      };\r\n    };\r\n\r\n    const initializeRazorpay = () => {\r\n      const options = {\r\n        key: \"rzp_test_a6hVvFHJbT9SAO\",\r\n        amount: totalPrice * 100, // Total price in paise\r\n        currency: \"INR\",\r\n        name: \"Your Company Name\",\r\n        description: `Payment for Order #${order.id}`,\r\n        order_id: order.id,\r\n        handler: async (response) => {\r\n          try {\r\n            console.log(\"Payment successful, response:\", response);\r\n            const { razorpay_payment_id, razorpay_order_id, razorpay_signature } = response;\r\n\r\n            // Prepare payment data for backend\r\n            const paymentData = {\r\n              razorpay_payment_id,\r\n              razorpay_order_id,\r\n              razorpay_signature,\r\n              amount: totalPrice * 100,\r\n            };\r\n\r\n            // Send payment data to backend\r\n            const paymentResponse = await axios.post(\r\n              \"http://localhost:8000/medical_store_app/payment_details/\",\r\n              paymentData\r\n            );\r\n            console.log(\"Payment recorded in backend:\", paymentResponse.data);\r\n\r\n            // Clear the cart\r\n            if (typeof clearCart === \"function\") {\r\n              console.log(\"Clearing cart...\");\r\n              clearCart(); // Clear cart in parent component\r\n            } else {\r\n              console.warn(\"clearCart function is not defined or not passed.\");\r\n            }\r\n\r\n            // Redirect to booking page\r\n            navigate(\"/booking\", {\r\n              state: {\r\n                order,\r\n                paymentDetails: paymentData,\r\n              },\r\n            });\r\n          } catch (error) {\r\n            console.error(\"Error processing payment:\", error);\r\n            alert(\"Payment was successful, but there was an issue processing the order. Please contact support.\");\r\n          }\r\n        },\r\n        prefill: {\r\n          name: \"Customer Name\",\r\n          email: \"customer@example.com\",\r\n          contact: \"9999999999\",\r\n        },\r\n        theme: {\r\n          color: \"#F37254\",\r\n        },\r\n        modal: {\r\n          ondismiss: () => {\r\n            alert(\"Payment cancelled. You can try again.\");\r\n          },\r\n        },\r\n      };\r\n\r\n      const razorpay = new window.Razorpay(options);\r\n      razorpay.open();\r\n    };\r\n\r\n    loadRazorpay();\r\n  }, [order, totalPrice, navigate, clearCart]);\r\n\r\n  if (!order || !totalPrice) {\r\n    return <div style={styles.error}>Error: Missing order or total price details.</div>;\r\n  }\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <h2 style={styles.heading}>Checkout</h2>\r\n      <p style={styles.message}>Your payment is being processed, please wait...</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    padding: '20px',\r\n    textAlign: 'center',\r\n    fontFamily: 'Arial, sans-serif',\r\n    backgroundColor: '#f4f4f9',\r\n    borderRadius: '8px',\r\n    boxShadow: '0 4px 8px rgba(0, 0, 0, 0.1)',\r\n    maxWidth: '600px',\r\n    margin: 'auto',\r\n  },\r\n  heading: {\r\n    fontSize: '24px',\r\n    color: '#333',\r\n    marginBottom: '20px',\r\n  },\r\n  message: {\r\n    fontSize: '18px',\r\n    color: '#555',\r\n  },\r\n  error: {\r\n    color: 'red',\r\n    fontSize: '18px',\r\n    textAlign: 'center',\r\n    marginTop: '20px',\r\n  },\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}